+ The conditons that have to be met for this vulnerebility to be exploited make it less likeley
to be exploited
    + PersistentManager must be enabled manually as it is disabled by default.
    + Even if PersistentManager is enabled it has to be configured to store files to a 
    filesystem with FileStore.
    + There has to be a seprate file upload vulnerebility to upload serialized objects files
    to the server assuming the webapp is importing libraries(gadgets) used for a deserialization attack to work.
    + The file upload vulnerebility allows uploading of '.session' files.
    + The file upload vulnerebility allows uploading to the session storage directory

## Vulnerebility Check
+ Simply prepending './' to the JSESSION cookie after waiting idle for some time 
and analyzing the response. if the response headers include `Set-Cookie:` the server is likely
not vulnerable. But be sure to wait for some time before checking because the time being idle required to 
to store the cookie may be longer than 5 minutes.

+ It is also possible that the server uses a database to store the sessions in which case it is not 
vunlnerable

## POC Setup
+ Configure tomcat to use PersistentManager instead of StandardManager 
for session management by adding this to conf/context.xml.
    ```
  <Manager className="org.apache.catalina.session.PersistentManager" maxIdleSwap="15">
    <Store className="org.apache.catalina.session.FileStore"
          directory="./session/" />
    </Manager> 
  ```
+ Now after some time has past idle user sessions will be stored to the ./session/ directory inside 
the tomcat installation directory, or if it is installed with catalina it goes into work/catalina/hostname/session
+ Add one gadget library for demonstration. Like the apache commons collections(https://mvnrepository.com/artifact/org.apache.commons/commons-collections4) library
+ The storage format will be session/\[JSESSION-token\].session
+ Injecting ../../../../../../opt/tomcat/uploads/payload as the JSESSIONID after uploading a pyload
to the uploads directory with a name payload.session will cause tomcat to deserialize it instead.

## Resources
when generating a payload (http://jackson-t.ca/runtime-exec-payloads.html)